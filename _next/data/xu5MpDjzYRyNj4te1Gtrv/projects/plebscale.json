{"pageProps":{"project":{"id":6,"slug":"plebscale","assetRoot":"projects/plebscale","title":"Plebscale","status":"wip","description":"Old PC's + Old SBC's = Plebian Internal Cloud","startDate":"2021-01-01T00:00:00.000Z","endDate":null,"url":null,"source":["https://github.com/astralbijection/astrid.tech-deployment"],"thumbnail":"/2021/01/27/pi-clustering/nodezzz.jpeg","content":"<p>This project is an internal cloud that is scaled enough to meet the demands of a single pleb like me.</p>\n<h2 id=\"goals-of-this-project\">Goals of this project</h2>\n<ul>\n<li>Learn how to use industry-standard DevOps tools</li>\n<li>Try to adhere to Infrastructure as Code (IaC)</li>\n<li>Give these old devices an actual use</li>\n</ul>\n<h2 id=\"technology-stack\">Technology Stack</h2>\n<h3 id=\"end-user-services-planned-and-completed\">End-User Services, planned and completed</h3>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th>Name</th><th>Status</th><th>Deployed on</th><th>Description</th></tr></thead><tbody><tr><td>OctoPrint</td><td>Deployed</td><td>Bare Metal</td><td>3D Printer sender with web UI</td></tr><tr><td>Firefly III</td><td>Deployed</td><td>k3s</td><td>Budgeting App</td></tr><tr><td>Printer Image Snapper</td><td>Deployed</td><td>k3s</td><td>Periodically takes pictures of my 3D Printer and uploads them to the internet</td></tr><tr><td>DokuWiki, D&#x26;D</td><td>Deployed</td><td>Docker Compose</td><td>A wiki for worldbuilding my D&#x26;D campaign</td></tr><tr><td>Trilium Notes</td><td>Deployed</td><td>k3s</td><td>Personal wiki/note-taking for school and more</td></tr><tr><td>Apache Spark</td><td><em>Planned</em></td><td>k3s</td><td>Big Data processing engine</td></tr><tr><td>Jupyter Notebook</td><td><em>Planned</em></td><td>k3s</td><td>Interactive code notebooks</td></tr><tr><td>Bookstack</td><td><em>Planned</em></td><td>k3s</td><td>“Internal” wiki for documenting this thing</td></tr><tr><td>ELabFTW</td><td><em>Planned</em></td><td>k3s</td><td>Lab notes</td></tr><tr><td>NextCloud</td><td><em>Planned</em></td><td>k3s</td><td>Personal cloud</td></tr></tbody></table>\n<h3 id=\"infrastructure-services\">Infrastructure Services</h3>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th>Name</th><th>Description</th><th>Deployed on</th></tr></thead><tbody><tr><td><a href=\"https://www.proxmox.com/en/\">Proxmox</a></td><td>An open-source Type 1 Hypervisor OS</td><td>Bare metal</td></tr><tr><td><a href=\"https://k3s.io/\">K3s</a></td><td>A lightweight Kubernetes distribution that won’t eat up most of the resources on a Raspberry Pi or craptop</td><td>VM</td></tr><tr><td>MySQL/MariaDB</td><td>Database</td><td>LXC</td></tr><tr><td>Postgres</td><td>Database</td><td>LXC</td></tr><tr><td><a href=\"https://docs.docker.com/compose/\">Docker Compose</a></td><td>Multi-container applications stack, useful for servers dedicated to a single purpose</td><td>Bare metal</td></tr><tr><td>NFS</td><td>File storage</td><td>LXC</td></tr></tbody></table>\n<h3 id=\"hardware\">Hardware</h3>\n<h4 id=\"flexible-home-resources\">Flexible Home Resources</h4>\n<p>These resources share a variety of workloads.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th>Name</th><th>Model</th><th>Arch</th><th>Processor</th><th>Cores</th><th>RAM (GB)</th><th>Role</th></tr></thead><tbody><tr><td>crappertop<sup id=\"fnref-fn-1\"><a href=\"#fn-fn-1\" class=\"footnote-ref\">fn-1</a></sup></td><td>Acer Aspire E1-510</td><td>amd64</td><td>Pentium N3520</td><td>4</td><td>4</td><td>Proxmox: k3s, nfs</td></tr><tr><td>cracktop<sup id=\"fnref-fn-2\"><a href=\"#fn-fn-2\" class=\"footnote-ref\">fn-2</a></sup></td><td>HP Pavilion x360 13</td><td>amd64</td><td>i5-2520M</td><td>4</td><td>8</td><td>Proxmox: k3s</td></tr><tr><td>thonkpad<sup id=\"fnref-fn-3\"><a href=\"#fn-fn-3\" class=\"footnote-ref\">fn-3</a></sup></td><td>Thinkpad T420</td><td>amd64</td><td>i5-6200U</td><td>4</td><td>8</td><td>Proxmox: k3s, db, nfs</td></tr><tr><td>zerg-1<sup id=\"fnref-fn-4\"><a href=\"#fn-fn-4\" class=\"footnote-ref\">fn-4</a></sup></td><td>Raspberry Pi 3B+</td><td>arm</td><td>BCM2837B0</td><td>4</td><td>1</td><td>k3s</td></tr><tr><td>zerg-2<sup id=\"fnref-fn-4\"><a href=\"#fn-fn-4\" class=\"footnote-ref\">fn-4</a></sup></td><td>Raspberry Pi 3B</td><td>arm</td><td>BCM2837</td><td>4</td><td>1</td><td>k3s</td></tr><tr><td>zerg-3<sup id=\"fnref-fn-4\"><a href=\"#fn-fn-4\" class=\"footnote-ref\">fn-4</a></sup></td><td>Raspberry Pi 2B+</td><td>arm</td><td>BCM2836</td><td>4</td><td>1</td><td>k3s</td></tr><tr><td>zerg-4<sup id=\"fnref-fn-4\"><a href=\"#fn-fn-4\" class=\"footnote-ref\">fn-4</a></sup></td><td>Orange Pi One</td><td>arm</td><td>sun8iw7p1</td><td>4</td><td>0.5</td><td>k3s</td></tr><tr><td><strong>Total</strong></td><td>---</td><td>---</td><td>---</td><td><strong>28</strong></td><td><strong>23.5</strong></td><td><strong>Wasting my Time</strong></td></tr></tbody></table>\n<p>Here’s what it all looks like.</p>\n<img src=\"/_/2021/01/27/pi-clustering/nodezzz.jpeg\" alt=\"Raspberry Pis involved in the cluster.\">\n<img src=\"/_/2021/01/21/janky-kube-cluster/cluster.jpeg\" alt=\"Hello from CyberCthulu\">\n<h4 id=\"turnkey-home-resources\">Turnkey Home Resources</h4>\n<p>These resources are dedicated to one purpose and one purpose only.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th>Name</th><th>Model</th><th>Role</th></tr></thead><tbody><tr><td>octopi</td><td>Raspberry Pi 2B+</td><td>OctoPrint</td></tr><tr><td>BANANA</td><td>Lenovo Legion Y530</td><td>Personal Computer: development, work, and gaming</td></tr></tbody></table>\n<h4 id=\"external-cloud-resources\">External Cloud Resources</h4>\n<p>Unfortunately, my internet connection is slow, so anything I want others to be able to use has to be hosted on an external cloud.</p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th>Name</th><th>Provider</th><th>Price ($/mo)</th><th>Arch</th><th>Processor</th><th>Cores</th><th>RAM (GB)</th><th>Role</th></tr></thead><tbody><tr><td>contabo</td><td>Contabo</td><td>7.90</td><td>amd64</td><td>Xeon something</td><td>4</td><td>8</td><td>Docker Compose</td></tr><tr><td>oci-1</td><td>Oracle</td><td>0</td><td>amd64</td><td>Xeon something</td><td>1</td><td>1</td><td>Docker Compose</td></tr><tr><td>oci-2</td><td>Oracle</td><td>0</td><td>amd64</td><td>Xeon something</td><td>1</td><td>1</td><td>Docker Compose</td></tr><tr><td><strong>Total</strong></td><td>---</td><td>7.90</td><td>---</td><td>---</td><td><strong>6</strong></td><td><strong>8</strong></td><td><strong>Wasting my Time</strong></td></tr></tbody></table>\n<h3 id=\"monitoring-services\">Monitoring Services</h3>\n<img src=\"/_/projects/plebscale/59a746baceb1e7c3288f903cc3b01d4895d28a3f.svg\" title=\"&#x60;dot&#x60; image\">\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<table><thead><tr><th>Name</th><th>Type</th><th>Description</th><th>Deployed on</th></tr></thead><tbody><tr><td>Fluent-bit</td><td>Logs</td><td>Reads logs from each node’s containers</td><td>k3s, Docker Compose</td></tr><tr><td>Fluentd</td><td>Logs</td><td>Centrally parses and processes logs</td><td>k3s</td></tr><tr><td>Loki</td><td>Logs</td><td>Stores and indexes logs</td><td>k3s</td></tr><tr><td>Prometheus</td><td>Metrics</td><td>Stores and indexes logs</td><td>k3s</td></tr><tr><td>Loki</td><td>Visualization</td><td>Stores and indexes logs</td><td>k3s</td></tr></tbody></table>\n<img src=\"/_/projects/plebscale/grafana.png\" alt=\"Look at this graaaaaaaph, every time I look it makes me laugh\">\n<h3 id=\"management-utilities\">Management Utilities</h3>\n<ul>\n<li>Ansible — Declaratively configuring servers</li>\n<li>Terraform — Declaratively provisioning resources</li>\n</ul>\n<h3 id=\"things-i-no-longer-use\">Things I no longer use</h3>\n<ul>\n<li>ELK Stack (Elasticsearch, Logstash, Kibana, Filebeat, Metricbeat) — This eats up a ridiculous amount of resources. As in, 6 GB (after attempts to minimize it) just dedicated to logging on a 28 GB cluster.</li>\n</ul>\n<div class=\"footnotes\">\n<hr>\n<ol>\n<li id=\"fn-fn-4\">Zerg rushing is essentially the “quantity-over-quality” tactic in strategy games: you send many expendable units against the enemy to hopefully overwhelm them.<a href=\"#fnref-fn-4\" class=\"footnote-backref\">↩</a></li>\n<li id=\"fn-fn-3\">:thinking: <a href=\"https://emoji.gg/assets/emoji/thonk.png\">https://emoji.gg/assets/emoji/thonk.png</a><a href=\"#fnref-fn-3\" class=\"footnote-backref\">↩</a></li>\n<li id=\"fn-fn-2\">This is my old laptop. I pulled it out of my backpack one day and saw the screen completely cracked for no good reason whatsoever.<a href=\"#fnref-fn-2\" class=\"footnote-backref\">↩</a></li>\n<li id=\"fn-fn-1\">My mom complained about it being really slow, and even with Linux, it’s still slow. Thus, it’s worse than crap.<a href=\"#fnref-fn-1\" class=\"footnote-backref\">↩</a></li>\n</ol>\n</div>","tags":["ansible","devops","docker","kubernetes","proxmox","raspberry-pi","terraform","upcycling"]},"similar":[{"slug":"goggle-epoxy","title":"Goggle Epoxy"},{"slug":"astrid-tech","title":"astrid.tech"}]},"__N_SSG":true}