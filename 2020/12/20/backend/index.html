<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><link title="astrid.tech RSS" rel="alternate" type="application/rss+xml" href="https://astrid.tech/rss.xml"/><link title="astrid.tech Atom" rel="alternate" type="application/atom+xml" href="https://astrid.tech/atom.xml"/><link title="astrid.tech JSON feed" rel="alternate" type="application/feed+json" href="https://astrid.tech/feed.json"/><link href="https://github.com/astralbijection" rel="me authn"/><link href="mailto:astrid@astrid.tech" rel="me"/><title>Adding a Backend to astrid.tech | astrid.tech</title><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="description" content="You thought I was done with this website?"/><meta name="twitter:card" content="summary"/><meta name="twitter:creator" content="astralbijection"/><meta name="twitter:title" content="Adding a Backend to astrid.tech"/><meta name="twitter:description" content="You thought I was done with this website?"/><meta property="og:title" content="Adding a Backend to astrid.tech"/><meta property="og:description" content="You thought I was done with this website?"/><meta property="og:type" content="website"/><meta name="robots" content="follow,index"/><meta property="og:url" content="https:/astrid.tech/2020/12/20/backend"/><link title="astrid.tech RSS" rel="alternate" type="application/rss+xml" href="https://astrid.tech/rss.xml"/><link title="astrid.tech Atom" rel="alternate" type="application/atom+xml" href="https://astrid.tech/atom.xml"/><link title="astrid.tech JSON feed" rel="alternate" type="application/feed+json" href="https://astrid.tech/feed.json"/><link href="https://github.com/astralbijection" rel="me authn"/><link href="mailto:astrid@astrid.tech" rel="me"/><meta name="next-head-count" content="23"/><link rel="preload" href="/_next/static/css/1d0d198a1c5bdedcad14.css" as="style"/><link rel="stylesheet" href="/_next/static/css/1d0d198a1c5bdedcad14.css" data-n-g=""/><link rel="preload" href="/_next/static/css/bd89e56ee668535d8996.css" as="style"/><link rel="stylesheet" href="/_next/static/css/bd89e56ee668535d8996.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-e7a279300235e161e32a.js"></script><script src="/_next/static/chunks/webpack-3071412ed8bc8fc49fc7.js" defer=""></script><script src="/_next/static/chunks/framework-2f612445bd50b211f15a.js" defer=""></script><script src="/_next/static/chunks/main-6bd02c179f9e0ec2bd5a.js" defer=""></script><script src="/_next/static/chunks/pages/_app-1658794de36b29c002aa.js" defer=""></script><script src="/_next/static/chunks/545f34e4-37710c009d2bbbd273c3.js" defer=""></script><script src="/_next/static/chunks/0c428ae2-571001351e1ed221a25c.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-fc4f6c929a53a9b582f6.js" defer=""></script><script src="/_next/static/chunks/398-1b9f48eb99654eeda62b.js" defer=""></script><script src="/_next/static/chunks/264-b52c4cdeb9e69930784f.js" defer=""></script><script src="/_next/static/chunks/146-41f4f1c63257555b1b33.js" defer=""></script><script src="/_next/static/chunks/993-2df73c7cf8296f032349.js" defer=""></script><script src="/_next/static/chunks/705-c9d82552f3ea55b2fe7a.js" defer=""></script><script src="/_next/static/chunks/pages/%5Byear%5D/%5Bmonth%5D/%5Bday%5D/%5B...slug%5D-e11dd750811444406993.js" defer=""></script><script src="/_next/static/xu5MpDjzYRyNj4te1Gtrv/_buildManifest.js" defer=""></script><script src="/_next/static/xu5MpDjzYRyNj4te1Gtrv/_ssgManifest.js" defer=""></script></head><body><div id="__next"><nav class="main-navbar navbar navbar-expand-md fixed-top"><a href="/" class="nav-link navbar-brand">astrid.tech</a><button aria-label="Toggle navigation" type="button" class="navbar-toggler"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M250.97 29.357c-106.557-.21-211.806 52.74-203.48 164.053 138.91 11.4 276.71 8.893 414.174.662 10.58-107.69-100.753-164.498-210.693-164.715zm59.876 23.996c11.165 0 20.216 4.468 20.216 9.98 0 5.513-9.051 9.981-20.216 9.981-11.166 0-20.217-4.468-20.217-9.98 0-5.513 9.051-9.98 20.217-9.98zm-111.852 19.83c11.165 0 20.217 4.469 20.217 9.98 0 5.513-9.052 9.981-20.217 9.981s-20.216-4.468-20.217-9.98c0-5.512 9.052-9.98 20.217-9.98zm178.057 34.02c11.165 0 20.216 4.468 20.217 9.98 0 5.512-9.052 9.98-20.217 9.98s-20.217-4.468-20.217-9.98c0-5.512 9.052-9.98 20.217-9.98zm-273.59 21.535c11.165 0 20.216 4.468 20.217 9.98 0 5.513-9.052 9.98-20.217 9.98s-20.217-4.467-20.217-9.98c0-5.512 9.052-9.98 20.217-9.98zm313.77 30.043c11.165 0 20.216 4.468 20.216 9.98 0 5.512-9.051 9.98-20.217 9.98-11.165 0-20.216-4.468-20.216-9.98 0-5.512 9.051-9.98 20.216-9.98zm-137.91 8.045c11.166 0 20.218 4.47 20.216 9.982 0 5.512-9.051 9.98-20.217 9.98-11.165 0-20.216-4.468-20.216-9.98-.002-5.513 9.05-9.982 20.216-9.982zM57.618 212.339c-18.964.405-9.028 24.485 14.383 24.573 128.554 10.208 236.673 9.686 372.117-2.42 16.096-2.708 25.212-13.087 10.824-21.969-131.579 7.67-263.81 10.045-397.324-.184zm403.024 40.612c-131.224 13.6-277.594 10.525-390.065 1.904-46.983-6.226-47.875 46.785-17.014 52.309 146.18 14.663 271.826 10.735 415.137-.53 25.007-1.144 14.554-55.328-8.058-53.683zM20.986 366.679l15.332 9.434c6.342-8.416 17.876-32.05 33.319-32.192 19.122-.174 22.345 39.302 41.98 39.103 22.607-.228 37.828-31.548 52.447-30.882 22.09 1.008 26.333 35.9 43.557 35.928 24.089.04 31.439-36.39 46.805-35.334 21.458 1.475 33.246 28.274 50.879 29.178 19.004.974 30.654-33.027 43.265-32.748 16.61.366 28.31 32.46 54.24 33.193 15.345.434 29.694-37.411 37.005-36.815 14.417 1.174 26.549 20.548 36.085 34.835l15.114-9.776c-12.029-16.216-30.117-44.428-52.558-44.017-20.907.382-25.948 38.114-38.102 37.943-23.28-.328-33.756-32.164-52.598-33.346-19.356-1.214-30.475 33.636-43.353 32.768-18.954-1.277-27.303-29.16-49.475-29.917-19.62-.67-34.121 37.669-46.793 36.044-18.139-2.326-20.226-36.378-43.317-37.836-19.11-1.207-37.562 30.604-50.314 29.999-17.525-.833-25.243-40.224-45.41-39.986-21.826.258-39.145 30.34-48.108 44.424zm47.553 36.174c-8.342.686-18.198 4.251-21.85 12.424-2.452 6.662 19.173 8.558 21.114 8.695 128.615 8.104 254.354 8.26 389.8-1.345 9.225-.655 13.935-3.147 15.252-4.414 3.124-8.208-23.168-13.935-25.818-14.004-185.01-1.178-279.257 2.209-378.498-1.356zm395.555 37.192c-126.786 6.957-283.18 9.384-408.123.707l.521 38.67c135.917 4.617 275.647 3.99 406.658-.088z"></path></svg></button><div class="collapse navbar-collapse"><a class="nav-link" href="/projects/">Projects</a><a class="nav-link active" href="/latest/">Blog</a><div class="navbar-separator"></div><a class="nav-link" href="/about/">About</a></div></nav><div class="root-wrapper expand-height"><div class="text-light large" style="background-color:black;margin:0;padding:15px;padding-left:30px;padding-right:30px"><p style="text-align:center;margin:0"><b>Black Lives Matter.</b> Please consider donating to the<!-- --> <a href="https://www.paypal.me/SLOBailFund">San Luis Obispo, CA Bail Fund</a> <!-- -->or <a href="https://bailfunds.github.io">other bail funds</a> so we can make the world a just and equitable place for all people of all colors.</p></div><div style="background-color:#bae6b3"><nav class="page-heading_above__2RV0m"></nav><header class="page-heading_header__zwjn1"><h1>Adding a Backend to astrid.tech</h1><p>You thought I was done with this website?</p></header></div><div class="longform-layout_container__1bKFt container"><div class="row"><div class="longform-layout_content__gfokN col-lg-8"><article class="longform"><article class="longform"><div><p>My website currently only has a frontend. Now, that’s cool and all, but I want my website to be fancier than that, and have more user interactability that I can customize.</p>
<p>Okay, yes, there’s no one visiting my site to begin with, but that won’t stop me from wasting my time on this!</p>
<p>Some tasks, like commenting and analytics, are currently delegated to others (Disqus and Google Analytics to be precise). However, those services often track users and harvest their data. And plus, it would be fun and to code those features in myself. With all these in mind, that’s why I’m building a backend.</p>
<h2 id="planned-features">Planned Features</h2>
<p>I want to add the following features when I release it:</p>
<ul>
<li>A login system that supports signing in with other providers, like Google or Github</li>
<li>Self-hosted commenting</li>
<li>A thing that tracks how many hits my pages get, so that I can display that on the page</li>
</ul>
<p>Later on, I want to add more server-enhanced features:</p>
<ul>
<li>Blogging that’s faster than running a full rebuild of the site</li>
<li>Webmentions? IndieAuth?</li>
<li>Fun analytics stuff.</li>
<li>A full social media feed aggregator that tracks everything I post (not that I even post that much, though…)</li>
<li>Maybe even a forum system! (Or I could just roll a Mastodon instance and call it a day. Or both…)</li>
</ul>
<p>I’m also thinking of adding some other stuff to the server besides just a website backend. For example, a Minecraft server, or a Mastodon server.</p>
<h2 id="the-technical-crap">The technical crap</h2>
<h3 id="deployment-and-repo-organization">Deployment and repo organization</h3>
<p>The backend is currently on the <code>backend</code> branch of my git repo, located in the <code>astrid_tech_api</code> subfolder. It’s written in Django, and I’ll have an app for each major responsibility. Currently, I’m mostly working on commenting. I tried to build an authentication system, but I may have gone slightly overkill in that.</p>
<p>In terms of deployment, I’ll keep the frontend on Github Pages so I can leech off of Microsoft’s hosting.</p>
<p>For the backend, I’m looking at <a href="https://contabo.com/">Contabo</a>, because their rates look way better than anyone else I’ve seen. Their cheapest service is €4/mo ($4.89/mo) and it gives you 2 cores, 4GB RAM, and 300GB hybrid drive storage! It’s in Germany, however, which has 137ms latency from where I live, so that might not be the best. Their cheapest US-based service is €6/mo ($7.34/mo).</p>
<p>Even though I’m running containers, I’m avoiding container hosting because I’m really cheap and I don’t really care much for scalability. Plus, I want the experience of managing a server myself. I’m planning on Dockerizing my backend and deploying it with either docker-compose or Kubernetes. So far, docker-compose seems a lot easier to use, but Kubernetes may be a bit more commonplace in the tech industry.</p>
<a href="/_/2020/12/20/870a17808335a3153c16fa3ac70123a51c73e6f4.svg"><img src="/_/2020/12/20/870a17808335a3153c16fa3ac70123a51c73e6f4.svg" title="`dot` image" width="1200"/></a>
<h3 id="replacing-gatsby">Replacing Gatsby?</h3>
<p>With this new backend coming in, I’m also considering moving to a new frontend framework. Essentially, Gatsby has a lot of issues with it. One of them is the long build times, which is worsened by how unreliable the cache is with my several custom plugins. Most of the runtime seems to be in generating images, but it might not be doing it very optimally; when it generates images, my CPU isn’t being 100% used.</p>
<a href="/_/2020/12/20/gatsby-build-ci.png"><img src="/_/2020/12/20/gatsby-build-ci.png" alt="Wow, these are very long build times, I wonder what could be causing it?" width="1200"/></a>
<a href="/_/2020/12/20/gatsby-build.png"><img src="/_/2020/12/20/gatsby-build.png" alt="Image generation. It&#x27;s all image generation." width="1200"/></a>
<p>I wrote the following script to limit the size of every image in my repository to 1600x1600, but that only reduced build time by 30 seconds.</p>
<div class="remark-highlight"><pre class="language-sh"><code class="language-sh">maxsize () {
  convert $1 -resize 1600x1600\&amp;gt; $1
}

for file in $(find content assets -type f \( -iname &amp;quot;*.jpg&amp;quot; -o -iname &amp;quot;*.png&amp;quot; -o -iname &amp;quot;*.jpeg&amp;quot; \) )
do
  echo $file
  maxsize $file
done</code></pre></div>
<p>The other issue is that it’s <a href="https://twitter.com/tesseralis/status/1293649007739191296">run by a sketchy company</a> with a somewhat racist, sexist, and transphobic record, so I feel like I’d want to transition my own website off of that.</p>
<p>Using Next.js and building my own thumbnail generation/data pull system seems like the most logical alternative because:</p>
<ol>
<li>It uses React, so I don’t have to throw away all my components.</li>
<li>It’s also statically generated so I can keep my site fast. Plus, there’s an option for server-side rendering, allowing potentially faster updates if I choose to use it in the future.</li>
<li>It doesn’t prescribe for you a data sourcing system to use, meaning I can write a custom data pulling/processing system that’s more optimized for my site.</li>
<li>I don’t really see anything <em>too</em> massively controversial about Next.js from a quick Google search.</li>
</ol>
<h2 id="conclusion">Conclusion</h2>
<p>I will admit, I’m essentially taking a jackhammer to a nail for this entire solution. I’m only running a single server, there really isn’t a need for Kubernetes. Heck, even Docker is somewhat overkill for this. However, I’m doing all this to learn DevOps technologies that I’ve never used before, stepping outside of my comfort zone, because I’m curious about them.</p>
<p>It’s gonna be an interesting experience to add this in, because I’m essentially taking an established product and adding functionality to it while maintaining it. I’m essentially a one-woman end-to-end software development team. So, I’m fairly hopeful for this server setup, and I hope to get it out within the next few weeks.</p></div></article></article></div><div class="col-lg-4"><div class="longform-layout_sidebarGroup__1maJR"><table style="width:100%"><tbody><tr><th style="min-width:180px"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z"></path></svg> <!-- -->Date</th><td class="longform-layout_statusData__1GlEa">20 Dec 2020</td></tr></tbody></table></div><div class="longform-layout_sidebarGroup__1maJR"><h2>Tags</h2><div><p style="font-size:12pt;margin-bottom:3px"><a href="/projects/astrid-tech/"><span style="background-color:#0afbff;color:#000000;cursor:pointer" class="tag_tag__1JK8b p-category badge badge-secondary">/projects/astrid-tech/</span></a><a href="/t/django"><span style="background-color:#4a7aad;color:#ffffff;cursor:pointer" class="tag_tag__1JK8b p-category badge badge-secondary">Django</span></a><a href="/t/docker"><span style="background-color:#2391E6;color:#ffffff;cursor:pointer" class="tag_tag__1JK8b p-category badge badge-secondary">Docker</span></a><a href="/t/gatsby-js"><span style="background-color:#663399;color:#ffffff;cursor:pointer" class="tag_tag__1JK8b p-category badge badge-secondary">Gatsby.js</span></a><a href="/t/kubernetes"><span style="background-color:#0039f5;color:#ffffff;cursor:pointer" class="tag_tag__1JK8b p-category badge badge-secondary">kubernetes</span></a><a href="/t/next-js"><span style="background-color:#FFFFFF;color:#000000;cursor:pointer" class="tag_tag__1JK8b p-category badge badge-secondary">Next.js</span></a><a href="/t/python"><span style="background-color:#3572A5;color:#ffffff;cursor:pointer" class="tag_tag__1JK8b p-category badge badge-secondary">Python</span></a> </p></div></div></div></div></div><div class="container"><section id="comments"><h2>Comments</h2><div class="comments"><div><form class=""><div class="row form-group"><label for="comment-name" class="col-sm-4 col-form-label">Name (leave blank for anonymous)</label><div class="col-sm-8"><input type="text" name="name" id="comment-name" placeholder="Willy Shakespeare" class="form-control"/></div></div><div class="row form-group"><label for="comment-email" class="col-sm-4 col-form-label">Email (required)</label><div class="col-sm-8"><input type="email" name="email" id="comment-email" placeholder="user@example.com" class="form-control"/></div></div><div class="row form-group"><label for="comment-website" class="col-sm-4 col-form-label">Website</label><div class="col-sm-8"><input type="url" name="website" id="comment-website" placeholder="my.cool.site" class="form-control"/></div></div><div class="form-group"><label for="comment-body" class="">Comment (<!-- -->1000<!-- --> chars left)</label><textarea name="body" id="comment-body" placeholder="Type your comment here..." class="form-control"></textarea><small class="form-text text-muted">Markdown formatting is supported.</small></div><div class="row"><button type="button" class="btn btn-primary">Submit!</button></div></form></div></div></section></div></div><footer class="footer_footer__1KZqX"><div class="text-light small container"><div class="col"><nav class="row"><div class="col-6 col-sm-4"><a href="/privacy/">Privacy Policy</a></div><div class="col-6 col-sm-4"><a href="/licenses/">Open Source Licenses</a></div><div class="col-6 col-sm-4"><a href="/about/">About/Contact</a></div></nav></div><div class="col"><p>astrid.tech v<!-- -->2.0.0<!-- --> was created by Astrid Yu with a generous helping of <span title="tea" aria-label="tea" role="img">☕</span> and <span title="witchcraft" aria-label="witchcraft" role="img">🧙‍</span>. See the<!-- --> <a href="/projects/astrid-tech/">self-referential project page</a> <!-- -->or see the code yourself on<!-- --> <a href="https://github.com/astralbijection/astrid.tech">GitHub</a>.</p></div><div class="row"><div class="col"></div></div><div class="row"><div class="text-center col"><a href="https://www.gnu.org/licenses/agpl-3.0.en.html"><img alt="GNU Affero General Public License" width="100" height="40" src="/agpl.png"/></a><p><a href="https://github.com/astralbijection/astrid.tech">The source code of astrid.tech</a> <!-- -->is licensed under the<!-- --> <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">AGPL License</a>.<!-- --> </p></div><div class="text-center col"><p><a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"/></a><br/><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">The page content of astrid.tech</span> <!-- -->by<!-- --> <a xmlns:cc="http://creativecommons.org/ns#" href="https://astrid.tech" property="cc:attributionName" rel="cc:attributionURL">Astrid Yu</a> <!-- -->is licensed under a<!-- --> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.</p></div></div></div></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"id":10,"assetRoot":"2020/12/20","thumbnail":null,"title":"Adding a Backend to astrid.tech","description":"You thought I was done with this website?","slug":"backend","date":"2020-12-20T00:00:00.000Z","content":"\u003cp\u003eMy website currently only has a frontend. Now, that’s cool and all, but I want my website to be fancier than that, and have more user interactability that I can customize.\u003c/p\u003e\n\u003cp\u003eOkay, yes, there’s no one visiting my site to begin with, but that won’t stop me from wasting my time on this!\u003c/p\u003e\n\u003cp\u003eSome tasks, like commenting and analytics, are currently delegated to others (Disqus and Google Analytics to be precise). However, those services often track users and harvest their data. And plus, it would be fun and to code those features in myself. With all these in mind, that’s why I’m building a backend.\u003c/p\u003e\n\u003ch2 id=\"planned-features\"\u003ePlanned Features\u003c/h2\u003e\n\u003cp\u003eI want to add the following features when I release it:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eA login system that supports signing in with other providers, like Google or Github\u003c/li\u003e\n\u003cli\u003eSelf-hosted commenting\u003c/li\u003e\n\u003cli\u003eA thing that tracks how many hits my pages get, so that I can display that on the page\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eLater on, I want to add more server-enhanced features:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eBlogging that’s faster than running a full rebuild of the site\u003c/li\u003e\n\u003cli\u003eWebmentions? IndieAuth?\u003c/li\u003e\n\u003cli\u003eFun analytics stuff.\u003c/li\u003e\n\u003cli\u003eA full social media feed aggregator that tracks everything I post (not that I even post that much, though…)\u003c/li\u003e\n\u003cli\u003eMaybe even a forum system! (Or I could just roll a Mastodon instance and call it a day. Or both…)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eI’m also thinking of adding some other stuff to the server besides just a website backend. For example, a Minecraft server, or a Mastodon server.\u003c/p\u003e\n\u003ch2 id=\"the-technical-crap\"\u003eThe technical crap\u003c/h2\u003e\n\u003ch3 id=\"deployment-and-repo-organization\"\u003eDeployment and repo organization\u003c/h3\u003e\n\u003cp\u003eThe backend is currently on the \u003ccode\u003ebackend\u003c/code\u003e branch of my git repo, located in the \u003ccode\u003eastrid_tech_api\u003c/code\u003e subfolder. It’s written in Django, and I’ll have an app for each major responsibility. Currently, I’m mostly working on commenting. I tried to build an authentication system, but I may have gone slightly overkill in that.\u003c/p\u003e\n\u003cp\u003eIn terms of deployment, I’ll keep the frontend on Github Pages so I can leech off of Microsoft’s hosting.\u003c/p\u003e\n\u003cp\u003eFor the backend, I’m looking at \u003ca href=\"https://contabo.com/\"\u003eContabo\u003c/a\u003e, because their rates look way better than anyone else I’ve seen. Their cheapest service is €4/mo ($4.89/mo) and it gives you 2 cores, 4GB RAM, and 300GB hybrid drive storage! It’s in Germany, however, which has 137ms latency from where I live, so that might not be the best. Their cheapest US-based service is €6/mo ($7.34/mo).\u003c/p\u003e\n\u003cp\u003eEven though I’m running containers, I’m avoiding container hosting because I’m really cheap and I don’t really care much for scalability. Plus, I want the experience of managing a server myself. I’m planning on Dockerizing my backend and deploying it with either docker-compose or Kubernetes. So far, docker-compose seems a lot easier to use, but Kubernetes may be a bit more commonplace in the tech industry.\u003c/p\u003e\n\u003cimg src=\"/_/2020/12/20/870a17808335a3153c16fa3ac70123a51c73e6f4.svg\" title=\"\u0026#x60;dot\u0026#x60; image\"\u003e\n\u003ch3 id=\"replacing-gatsby\"\u003eReplacing Gatsby?\u003c/h3\u003e\n\u003cp\u003eWith this new backend coming in, I’m also considering moving to a new frontend framework. Essentially, Gatsby has a lot of issues with it. One of them is the long build times, which is worsened by how unreliable the cache is with my several custom plugins. Most of the runtime seems to be in generating images, but it might not be doing it very optimally; when it generates images, my CPU isn’t being 100% used.\u003c/p\u003e\n\u003cimg src=\"/_/2020/12/20/gatsby-build-ci.png\" alt=\"Wow, these are very long build times, I wonder what could be causing it?\"\u003e\n\u003cimg src=\"/_/2020/12/20/gatsby-build.png\" alt=\"Image generation. It\u0026#x27;s all image generation.\"\u003e\n\u003cp\u003eI wrote the following script to limit the size of every image in my repository to 1600x1600, but that only reduced build time by 30 seconds.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sh\"\u003e\u003ccode class=\"language-sh\"\u003emaxsize () {\n  convert $1 -resize 1600x1600\\\u0026#x26;gt; $1\n}\n\nfor file in $(find content assets -type f \\( -iname \u0026#x26;quot;*.jpg\u0026#x26;quot; -o -iname \u0026#x26;quot;*.png\u0026#x26;quot; -o -iname \u0026#x26;quot;*.jpeg\u0026#x26;quot; \\) )\ndo\n  echo $file\n  maxsize $file\ndone\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThe other issue is that it’s \u003ca href=\"https://twitter.com/tesseralis/status/1293649007739191296\"\u003erun by a sketchy company\u003c/a\u003e with a somewhat racist, sexist, and transphobic record, so I feel like I’d want to transition my own website off of that.\u003c/p\u003e\n\u003cp\u003eUsing Next.js and building my own thumbnail generation/data pull system seems like the most logical alternative because:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003eIt uses React, so I don’t have to throw away all my components.\u003c/li\u003e\n\u003cli\u003eIt’s also statically generated so I can keep my site fast. Plus, there’s an option for server-side rendering, allowing potentially faster updates if I choose to use it in the future.\u003c/li\u003e\n\u003cli\u003eIt doesn’t prescribe for you a data sourcing system to use, meaning I can write a custom data pulling/processing system that’s more optimized for my site.\u003c/li\u003e\n\u003cli\u003eI don’t really see anything \u003cem\u003etoo\u003c/em\u003e massively controversial about Next.js from a quick Google search.\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2 id=\"conclusion\"\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eI will admit, I’m essentially taking a jackhammer to a nail for this entire solution. I’m only running a single server, there really isn’t a need for Kubernetes. Heck, even Docker is somewhat overkill for this. However, I’m doing all this to learn DevOps technologies that I’ve never used before, stepping outside of my comfort zone, because I’m curious about them.\u003c/p\u003e\n\u003cp\u003eIt’s gonna be an interesting experience to add this in, because I’m essentially taking an established product and adding functionality to it while maintaining it. I’m essentially a one-woman end-to-end software development team. So, I’m fairly hopeful for this server setup, and I hope to get it out within the next few weeks.\u003c/p\u003e","tags":["/projects/astrid-tech/","django","docker","gatsby-js","kubernetes","next-js","python"]}},"__N_SSG":true},"page":"/[year]/[month]/[day]/[...slug]","query":{"year":"2020","month":"12","day":"20","slug":["backend"]},"buildId":"xu5MpDjzYRyNj4te1Gtrv","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>